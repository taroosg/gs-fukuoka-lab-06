# Like機能の実装3（集計とLike数表示）

## やりたいこと

- ここまででLike数を1ユーザあたり1件に制限する処理を実装した．
- しかし，現状ではLike状況を確認するにはphpmyadminにアクセスして確認するしかなくアプリケーション側に情報が表示されない．
- そこで，本項ではLikeされた件数をtodo一覧画面に表示するための処理を実装する．

## 手順

- Like情報が保存されている「Likeテーブル」を用いて，各todoが何件Likeされているのかを集計する．
- 「todoテーブル」と「集計結果のテーブル」を結合し，両方のデータを一度に取得できるようにする．
- 取得したデータを画面に表示する．

## 集計

GROUP BYを使うと集計ができる！

### 例（phpmyadminで実行しよう！）

```sql
SELECT
  todo_id,
  COUNT(id) AS like_count
FROM
  like_table
GROUP BY
  todo_id
```

「`like_table`」の「`todo_id`」ごとに「idの数」を「`like_count`」というカラム名で表示する．

集計したカラムのカラム名は自由に設定できる（しなくても良い）が，後ほど再利用する場合は何らかの名前を指定しておくのがオススメ．

実行すると下記のような集計結果のテーブルが表示される．下記は一例なので，`like_table`のデータによって件数は変化する．

|todo_id|like_count|
|-:|-:|
|1|1|
|2|1|
|4|2|
|5|2|

### 💡 Key Point

>このSQL文は「集計結果のテーブル」を出力する！！
### 注意点

- COUNT()で件数を取得しているが，集計関数以外だとエラーになる
- その他の集計関数
    - `MIN()`, `MAX()`, `SUM()`, etc...

